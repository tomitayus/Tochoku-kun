"""
当直表自動生成ツール - 設定ファイル (config.py)

月ごとに変わるパラメータをここで管理します。
このファイルだけ編集すれば月次運用できます。
"""
import os

# =========================
# ファイルパス設定
# =========================

# 入力Excelファイルのパス（data/ フォルダに配置してください）
# sheet1〜sheet4 が入ったExcelファイルを指定
INPUT_FILE = os.path.join("data", "Tochoku.xlsx")

# 出力先ディレクトリ（自動生成されます）
OUTPUT_DIR = os.path.join("data", "output")

# =========================
# 祝日設定
# =========================
# 対象月の祝日を "YYYY-MM-DD" 形式で追加してください
# 例: ["2026-03-21", "2026-04-29"]
HOLIDAYS = [
    # "2026-03-21",  # 春分の日
    # "2026-04-29",  # 昭和の日
    # "2026-05-03",  # 憲法記念日
    # "2026-05-04",  # みどりの日
    # "2026-05-05",  # こどもの日
]

# =========================
# スタッフ制約設定
# =========================

# 水曜日の H〜U列（外病院）を禁止する医師名リスト
WED_FORBIDDEN_DOCTORS = ["金城", "山田", "野寺"]

# =========================
# 生成パラメータ
# =========================

# 生成パターン数（多いほど良いパターンが見つかりやすいが時間がかかる）
# 推奨: 1000（速度重視なら100、品質重視なら3000〜10000）
NUM_PATTERNS = 1000

# 局所探索（swap）の有効/無効
# True: スコア改善のためランダムswapを試行（時間がかかる）
# False: greedy + fix関数パイプラインのみ（推奨）
LOCAL_SEARCH_ENABLED = False

# 最適化（fix関数パイプライン）の有効/無効
# True: safe_fixラッパーで各種制約違反を自動修正（推奨）
# False: greedyの結果をそのまま出力
OPTIMIZATION_ENABLED = True

# =========================
# スコア重み（上級者向け・通常は変更不要）
# =========================
# ソフト制約の重み。値が大きいほど優先される。
# ABS/HARD制約はfix関数で強制されるため重み不要。

W_FAIR_TOTAL = 30       # SOFT-001: 公平性（max-min最小化）
W_CODE_12_UNIV = 150    # SOFT-002: コード1.2の医師は大学系最低1回
W_BG_HT_DIFF = 100      # SOFT-003: 大学/外病院の差が3以上でペナルティ
W_UNASSIGNED = 500       # 未割当枠のペナルティ
W_BK_LY_BALANCE = 2     # B-K/L-Y列の比率バランス
